import{a as A,b as O,c as B,d as L,e as z,f as G,g as q,h as H}from"./chunk-SQGIQ26W.js";import{i as U,j,p as F}from"./chunk-M4RPJYBD.js";import{Ja as k,P as E,U as p,Ua as S,V as u,Va as C,Wa as w,Xa as _,Ya as D,Za as n,_a as t,a as P,b as M,db as I,ea as b,gb as h,hb as c,mb as V,nb as i,ob as v,pb as m,qb as N,rb as x,sb as g,tb as f,vb as T,wa as a,wb as W}from"./chunk-67WPBUNM.js";var y=(l,o)=>o.id;function K(l,o){if(l&1&&(n(0,"div",10)(1,"div")(2,"h4",15),i(3),t(),n(4,"p",16),i(5),t()(),n(6,"div",17),i(7),t()()),l&2){let e=o.$implicit;a(3),v(e.name),a(2),N("",e.productId," \u2022 ",(e.priceCents/100).toFixed(2)," ",e.currency),a(2),m(" $ ",(e.priceCents/100).toFixed(2)," ")}}function Q(l,o){if(l&1&&(n(0,"div",12)(1,"div",18)(2,"div",19),i(3),t(),n(4,"div")(5,"p",20),i(6),t(),n(7,"p",21),i(8),T(9,"date"),t()()(),n(10,"span"),i(11),t()()),l&2){let e=o.$implicit,s=c();a(3),m(" ",e.tenantId," "),a(3),m("Tenant #",e.tenantId),a(2),m("Exp: ",W(9,6,e.expiresAt,"shortDate")),a(2),V("px-2 py-1 rounded-full text-[10px] font-black uppercase "+s.getStatusClass(e.status)),a(),m(" ",e.status," ")}}function R(l,o){l&1&&(n(0,"p",13),i(1,"No hay suscripciones registradas."),t())}function X(l,o){if(l&1&&(n(0,"option",27),i(1),t()),l&2){let e=o.$implicit;D("value",e.id),a(),v(e.name)}}function Y(l,o){if(l&1){let e=I();n(0,"div",14)(1,"div",22)(2,"h3",23),i(3,"Crear Nuevo Plan"),t(),n(4,"div",24)(5,"div")(6,"label",25),i(7,"Producto SaaS"),t(),n(8,"select",26),f("ngModelChange",function(r){p(e);let d=c();return g(d.newPlan.productId,r)||(d.newPlan.productId=r),u(r)}),w(9,X,2,2,"option",27,y),t()(),n(11,"div")(12,"label",25),i(13,"Nombre del Plan"),t(),n(14,"input",28),f("ngModelChange",function(r){p(e);let d=c();return g(d.newPlan.name,r)||(d.newPlan.name=r),u(r)}),t()(),n(15,"div",29)(16,"div")(17,"label",25),i(18,"Precio (USD/mes)"),t(),n(19,"input",30),f("ngModelChange",function(r){p(e);let d=c();return g(d.newPlan.priceUSD,r)||(d.newPlan.priceUSD=r),u(r)}),t()(),n(20,"div")(21,"label",25),i(22,"Moneda"),t(),n(23,"input",31),f("ngModelChange",function(r){p(e);let d=c();return g(d.newPlan.currency,r)||(d.newPlan.currency=r),u(r)}),t()()()(),n(24,"div",32)(25,"button",33),h("click",function(){p(e);let r=c();return u(r.showPlanModal.set(!1))}),i(26,"Cancelar"),t(),n(27,"button",34),h("click",function(){p(e);let r=c();return u(r.savePlan())}),i(28,"Guardar Plan"),t()()()()}if(l&2){let e=c();a(8),x("ngModel",e.newPlan.productId),a(),_(e.products()),a(5),x("ngModel",e.newPlan.name),a(5),x("ngModel",e.newPlan.priceUSD),a(4),x("ngModel",e.newPlan.currency)}}var J=class l{api=E(F);plans=b([]);subscriptions=b([]);products=b([]);showPlanModal=b(!1);newPlan={productId:0,name:"",priceUSD:0,currency:"USD"};ngOnInit(){this.loadData()}loadData(){this.api.getPlans().subscribe(o=>this.plans.set(o)),this.api.getSubscriptions().subscribe(o=>this.subscriptions.set(o)),this.api.getProducts().subscribe(o=>{this.products.set(o),o.length>0&&(this.newPlan.productId=o[0].id)})}savePlan(){this.api.createPlan(M(P({},this.newPlan),{priceCents:Math.round(this.newPlan.priceUSD*100)})).subscribe(()=>{this.loadData(),this.showPlanModal.set(!1),this.newPlan={productId:this.products()[0]?.id||0,name:"",priceUSD:0,currency:"USD"}})}getStatusClass(o){switch(o){case"active":return"bg-green-500/10 text-green-400 border border-green-500/20";case"past_due":return"bg-rose-500/10 text-rose-400 border border-rose-500/20";case"canceled":return"bg-slate-500/10 text-slate-400 border border-slate-500/20";default:return"bg-slate-500/10 text-slate-400 border border-slate-500/20"}}static \u0275fac=function(e){return new(e||l)};static \u0275cmp=k({type:l,selectors:[["app-subscriptions"]],decls:25,vars:2,consts:[[1,"space-y-6"],[1,"flex","justify-between","items-center"],[1,"text-2xl","font-bold","text-white"],[1,"text-slate-400"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8"],[1,"bg-slate-900","border","border-slate-800","p-8","rounded-2xl","shadow-xl","space-y-6"],[1,"flex","justify-between","items-center","border-b","border-slate-800","pb-4"],[1,"text-lg","font-bold","text-white"],[1,"text-xs","bg-indigo-500/10","text-indigo-400","px-3","py-1","rounded-lg","border","border-indigo-500/20","hover:bg-indigo-500/20","transition-all","font-bold","uppercase","tracking-wider",3,"click"],[1,"space-y-4"],[1,"bg-slate-800/30","border","border-slate-700","p-4","rounded-xl","flex","justify-between","items-center"],[1,"text-lg","font-bold","text-white","border-b","border-slate-800","pb-4"],[1,"flex","items-center","justify-between","p-4","bg-slate-800/20","rounded-xl","border","border-slate-700/30"],[1,"text-center","text-slate-500","py-8","italic","font-light"],[1,"fixed","inset-0","bg-black/60","backdrop-blur-sm","flex","items-center","justify-center","p-4","z-50"],[1,"text-white","font-bold"],[1,"text-xs","text-slate-500","font-mono"],[1,"text-indigo-400","font-black","text-lg"],[1,"flex","items-center","gap-3"],[1,"w-8","h-8","rounded-full","bg-slate-700","flex","items-center","justify-center","font-bold","text-xs","text-white"],[1,"text-sm","font-bold","text-white"],[1,"text-[10px]","text-slate-500","uppercase","font-black"],[1,"bg-slate-900","border","border-slate-800","w-full","max-w-md","rounded-2xl","shadow-2xl","p-8","transform","animate-in","zoom-in-95"],[1,"text-xl","font-bold","text-white","mb-6"],[1,"space-y-4","text-sm"],[1,"block","mb-2","text-slate-400","font-medium"],[1,"bg-slate-800","border","border-slate-700","text-white","rounded-xl","block","w-full","p-3","outline-none",3,"ngModelChange","ngModel"],[3,"value"],["type","text","placeholder","Ej: Scale / Enterprise",1,"bg-slate-800","border","border-slate-700","text-white","rounded-xl","block","w-full","p-3","outline-none",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-2","gap-4"],["type","number","placeholder","99.00",1,"bg-slate-800","border","border-slate-700","text-white","rounded-xl","block","w-full","p-3",3,"ngModelChange","ngModel"],["type","text",1,"bg-slate-800","border","border-slate-700","text-white","rounded-xl","block","w-full","p-3","font-mono",3,"ngModelChange","ngModel"],[1,"flex","gap-3","mt-8"],[1,"flex-1","px-4","py-3","bg-slate-800","hover:bg-slate-700","text-white","rounded-xl","transition-all",3,"click"],[1,"flex-1","px-4","py-3","bg-indigo-600","hover:bg-indigo-700","text-white","rounded-xl","transition-all","shadow-lg","shadow-indigo-500/20",3,"click"]],template:function(e,s){e&1&&(n(0,"div",0)(1,"div",1)(2,"div")(3,"h2",2),i(4,"Planes y Suscripciones"),t(),n(5,"p",3),i(6,"Gestiona los modelos de negocio y el estado de pago de los clientes."),t()()(),n(7,"div",4)(8,"div",5)(9,"div",6)(10,"h3",7),i(11,"Planes de Pago"),t(),n(12,"button",8),h("click",function(){return s.showPlanModal.set(!0)}),i(13," Nuevo Plan "),t()(),n(14,"div",9),w(15,K,8,5,"div",10,y),t()(),n(17,"div",5)(18,"h3",11),i(19,"Suscripciones Activas"),t(),n(20,"div",9),w(21,Q,12,9,"div",12,y),S(23,R,2,0,"p",13),t()()(),S(24,Y,29,4,"div",14),t()),e&2&&(a(15),_(s.plans()),a(6),_(s.subscriptions()),a(2),C(s.subscriptions().length===0?23:-1),a(),C(s.showPlanModal()?24:-1))},dependencies:[j,H,G,q,A,L,z,O,B,U],styles:["[_nghost-%COMP%]{display:block}"]})};export{J as SubscriptionsComponent};
